@model IEnumerable<Institution>
@{
    ViewData["Title"] = "Equalize";
   
}
<div class="background-image"></div>
    <div class="container">
        

        <main class="main-body">
            <div>
            <div class="card">
            <div class="card-header custom-darker-danger">
                    <h3>معلومات الطالب</h3>
                </div>
            <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="previousInstitution">المنشأة السابقة</label>
                                <select class="form-control" id="institutionId" onchange="fetchMajors(this.value)">
                                    <option value=""></option>
                                    @foreach (var institution in Model)
                                    {
                                        <option value="@institution.institutionID">@institution.institutionNameAR</option>
                                    }
                                </select>

                            </div>
                            <div class="form-group">
                                <label for="major">التخصص</label>
                                <select class="form-control" id="major" onchange="fetchCourses()">
                                    <option value=""></option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="studentName">اسم الطالب</label>
                                <input type="text" class="form-control" id="studentName">
                            </div>
                            <div class="form-group">
                                <label for="studentId">الرقم الجامعي للطالب</label>
                                <input type="text" class="form-control" id="studentId">
                            </div>
                        </div>
                        <div class="col-md-6 ">
                            <div class="form-group">
                                <label for="nationality">الجنسية</label>
                                <select class="form-control" id="nationality">
                                    <option value=""></option>
                                    <option value="jordanian">اردني</option>
                                    <option value="foreigner">اجنبي</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="Case">الحالة</label>
                                <select class="form-control" id="Case">
                                    <option value="Case"></option>
                                    <option value="ComingFromUniversity">مجسر</option>
                                    <option value="ComingFromCollege">منتقل</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mt-4">
            <div class="card-header custom-darker-danger">
                    <h3>اختيار المواد المجتازة</h3>
                </div>
                <div class="card-body">
                    <table class="table" id="course">
                        <thead>
                        <tr class="custom-darker-danger">
                                <th>اسم المادة</th>
                                <th>وصف المادة</th>
                                <th>وزن المادة</th>
                                <th>مجتازة</th>
                            </tr>
                        </thead>
                        <tbody>
                            
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="text-center mt-4">
                <button type="button" class="btn btn-primary custom-darker-danger">معادلة</button>
                <button type="button" class="btn btn-secondary custom-darker-danger">طباعة النتيجة بصيغة PDF</button>
            </div>
            </div>
        </main>


    </div>
   
<script>
    function fetchMajors(id) {
        $.ajax({
            url: '/Equalize/getMajors/' + id,
            type: 'GET',
            success: function (data) {
                $('#major').empty(); 
                $.each(data, function (index, item) {
                    $('#major').append('<option value="' + 0 + '">' + 'اختر التخصص' + '</option>');

                    $('#major').append('<option value="' + item.majorID + '">' + item.majorNameAR + '</option>');
                });
                institutionId = id;
            },
            error: function (xhr, status, error) {
                console.error(error);
            }
        });
    }
</script>
<script>
    function fetchCourses() {
        var majorId = $('#major').val();
        var institutionId = $('#institutionId').val();
        $.ajax({
            
            url: '/Equalize/getCourses/',
            type: 'GET',
            data: { institutionId: institutionId, majorId: majorId },
            success: function (result) {
                $('#course tbody').empty();
                $.each(result, function (index, item) {
                    var row = '<tr>' +
                        '<td>' + item.courseNameAR + '</td>' +
                        '<td>' + item.courseDescriptionAR + '</td>' +
                        '<td>' + item.courseWeightAR + '</td>' +
                        '<td> <input type="checkbox" name="pass"> </td>' +
                        '</tr>';
                    $('#course tbody').append(row);
                });
            },
            error: function (xhr, status, error) {
                console.error(error);
            }
        });
    }
</script>
